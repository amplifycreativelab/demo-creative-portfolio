---
import BaseLayout from "../layouts/BaseLayout.astro";
import Section from "../components/Section.astro";
import ButtonEnhanced from "../components/ButtonEnhanced.astro";
import CaseStudyCardEnhanced from "../components/CaseStudyCardEnhanced.astro";
import StatsStrip from "../components/StatsStrip.astro";
import TestimonialQuote from "../components/TestimonialQuote.astro";
import HeroEnhanced from "../components/HeroEnhanced.astro";
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import { site, serviceHighlights, processSteps, metrics } from "../data/site";
import { withBase } from "../utils/paths";
import "../styles/global-enhanced.css";
import styles from "./_index-enhanced.module.css";

const caseStudies = await getCollection("caseStudies");
const featured = caseStudies.filter((entry) => entry.data.featured);
---

<BaseLayout>
  <!-- Hero Section -->
  <HeroEnhanced />

  <!-- Featured Work Section -->
  <Section
    kicker="Editor's Picks"
    title="Featured Work"
    intro="Three case studies shaping the studio this quarter."
  >
    <div class={styles.featuredGrid}>
      {featured.map((entry, index) => (
        <CaseStudyCardEnhanced 
          entry={entry} 
          featured={index === 0}
        />
      ))}
    </div>
  </Section>

  <!-- Services Section -->
  <Section
    kicker="What We Do"
    title="Editorial Services"
    intro="A small studio offering focused, high-impact collaborations."
  >
    <div class={styles.servicesList}>
      {serviceHighlights.map((service, index) => (
        <article class={styles.serviceItem} data-index={index}>
          <div class={styles.serviceNumber}>
            <span class={styles.serviceNumberText}>{String(index + 1).padStart(2, "0")}</span>
            <div class={styles.serviceNumberLine}></div>
          </div>
          <div class={styles.serviceContent}>
            <h3>{service.title}</h3>
            <p>{service.summary}</p>
            <a
              class={styles.serviceLink}
              href={withBase(`work/?category=${service.category}`)}
            >
              <span>Explore</span>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
              </svg>
            </a>
          </div>
        </article>
      ))}
    </div>
  </Section>

  <!-- Process Section -->
  <section class={styles.process}>
    <div class="container">
      <div class={styles.processHeader}>
        <span class="kicker">Our Process</span>
        <h2>How We Work</h2>
      </div>
      <div class={styles.processGrid}>
        {processSteps.map((step, index) => (
          <div class={styles.processItem} data-index={index}>
            <div class={styles.processNumber}>{String(index + 1).padStart(2, "0")}</div>
            <div class={styles.processContent}>
              <h3>{step.title}</h3>
              <p>{step.detail}</p>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Metrics Section -->
  <section class={styles.metrics}>
    <div class="container">
      <div class={styles.metricsInner}>
        <div class={styles.metricsHeader}>
          <span class="kicker">Results</span>
          <h2>Numbers That Matter</h2>
        </div>
        <StatsStrip items={metrics} />
      </div>
    </div>
  </section>

  <!-- Testimonial Section -->
  <Section kicker="Testimonial" title="Client Note">
    <TestimonialQuote
      quote="Creative Portfolio brought clarity and pace. The work feels premium and performs."
      name="Sienna V."
      role="Marketing Director"
      location="Central District"
    />
  </Section>

  <!-- CTA Section -->
  <section class={styles.ctaBand}>
    <div class="container">
      <div class={styles.ctaInner}>
        <div class={styles.ctaContent}>
          <span class="kicker">Ready to Build?</span>
          <h2>Plan a project that delivers on story and performance.</h2>
        </div>
        <div class={styles.ctaActions}>
          <ButtonEnhanced href={withBase("contact/")} variant="primary" size="lg">
            Start a Project
          </ButtonEnhanced>
          <a
            class={styles.ctaEmail}
            href="https://amplifycreativelab.com"
            target="_blank"
            rel="nofollow noopener noreferrer"
          >
            <span>amplifycreativelab.com</span>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
              <polyline points="15 3 21 3 21 9"></polyline>
              <line x1="10" y1="14" x2="21" y2="3"></line>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<script>
  // Scroll-triggered animations
  document.addEventListener('DOMContentLoaded', () => {
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate');
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);
    
    // Observe all animate elements
    document.querySelectorAll('[data-animate]').forEach(el => {
      observer.observe(el);
    });
    
    // Service items stagger animation
    const serviceItems = document.querySelectorAll('.index-enhanced-module_css-serviceItem');
    serviceItems.forEach((item, index) => {
      const itemEl = item as HTMLElement;
      itemEl.style.animationDelay = `${index * 0.1}s`;
    });
    
    // Process items stagger animation
    const processItems = document.querySelectorAll('.index-enhanced-module_css-processItem');
    processItems.forEach((item, index) => {
      const itemEl = item as HTMLElement;
      itemEl.style.animationDelay = `${index * 0.15}s`;
    });
  });
</script>
